\documentclass[a4paper, 12pt]{article}		% general format

%%%% Charset
\usepackage{cmap}							% make PDF files searchable and copyable
\usepackage[utf8x]{inputenc}				% accept different input encodings
\usepackage[T2A]{fontenc}					% russian font
\usepackage[russian]{babel}					% multilingual support (T2A)

%%%% Graphics
\usepackage[dvipsnames]{xcolor}			% driver-independent color extensions
\usepackage{graphicx}						% enhanced support for graphics
\usepackage{wrapfig}						% produces figures which text can flow around

%%%% Math
\usepackage{amsmath}						% American Mathematical Society (AMS) math facilities
\usepackage{amsfonts}						% fonts from the AMS
\usepackage{amssymb}						% additional math symbols

%%%% Typograpy (don't forget about cm-super)
\usepackage{microtype}						% subliminal refinements towards typographical perfection
\linespread{1.3}							% line spacing
\usepackage[left=2.5cm, right=1.5cm, top=2.5cm, bottom=2.5cm]{geometry}
\setlength{\parindent}{0pt}					% we don't want any paragraph indentation
\usepackage{parskip}						% some distance between paragraphs

%%%% Tables
\usepackage{tabularx}						% tables with variable width columns
\usepackage{multirow}						% for tabularx
\usepackage{hhline}							% for tabularx

%%%% Graph
\usepackage{tikz}							% package for creating graphics programmatically
\usetikzlibrary{arrows}						% edges for tikz

%%%% Other
\usepackage{url}							% verbatim with URL-sensitive line breaks
\usepackage{fancyvrb}						% sophisticated verbatim text (with box)
%------------------------------------------------------------------------------

\begin{document}

\input{titlepage}
\tableofcontents

%------------------------------------------------------------------------------
\input{intro}

%------------------------------------------------------------------------------
\input{install}

%------------------------------------------------------------------------------
\newpage
\section{Разработка архитектуры ККС}

Рабочий макет стандартной схемы ККС (реализованной в виде многосегментной локальной сети), подключенной к внешней сети (названной для общности Интернет) показан на рисунке 1. Для простоты в каждый сегмент сети помещен только один хост.

\begin{figure}[h!]
\centering
\includegraphics[scale=1]{res/network_general}
\caption{Рабочий макет стандартной схемы ККС.}
\end{figure}

Эмулируемая ККС имеет три сегмента (подсети):
\begin{itemize}
\item VMnet1 (адрес подсети – 192.168.40.0)
\item VMnet2 (адрес подсети – 192.168.80.0)
\item VMnet3 (адрес подсети – 192.168.120.0)
\end{itemize}

Сеть VMnet1 содержит основной многофункциональный сервер ККС (службы DHCP, DNS, Web, Proxy, почтовая, файловая и др.), использующий ОС Linux Mandrake. Сеть VMnet2 представлена хостом под управлением ОС Windows 2k (2000/XP/2003 Server) и имеет двойное назначение – она обеспечивает ККС дополнительным сервером и поддерживает Windows-клиент семейства 2k. Сеть VMnet3 объединяет рабочие станции c ограниченными аппаратными ресурсами, ориентированные на ОС Windows семейства 9x (95/98).

Взаимодействие сегментов ККС осуществляет маршрутизатор, обслуживаемый ОС семейства Unix (FreeBSD), а подключение ККС к внешней сети (Интернет или реальной сети учебной лаборатории) обеспечивает шлюз, реализуемый другой ОС семейства Unix (NetBSD).

Естественно, что каждый представитель подсетей (VMnet1, Vmnet2, VMnet3) имеет один сетевой адаптер, шлюз – два, а маршрутизатор – три сетевых адаптера.

Для определённости будем считать, что ККС использует смешанное (и статическое, и динамическое) распределение IP-адресов. 

Хост WIN98 (здесь и далее имя хоста формируется от названия гостевой ОС) имеет статический адрес 192.168.120.15, хост LINUX также имеет статический адрес – 192.168.40.32, а хост WIN2000 получает адрес 192.168.80.128 динамически с помощью виртуального сервера DHCP (встроенного по умолчанию в каждый сегмент сети, эмулируемой в среде VMware Workstation).

\begin{figure}[h!]
\centering
\includegraphics[scale=1]{res/network_general2}
\caption{Cтандартная схема ККС.}
\end{figure}

Целесообразно выделить статические адреса для хостов FREEBSD (маршрутизатор) и NETBSD (шлюз). Для простоты адресам всех сетевых адаптеров маршрутизатора назначим одинаковые суффиксы – 192.168.40.2 (для связи с сетью VMnet1), 192.168.80.2 (для связи с сетью VMnet2), 192.168.120.2 (для связи с сетью VMnet3). Функциональное назначение шлюза (обеспечение взаимодействия ККС с внешними сетями) предполагает наличие какого-нибудь механизма сопряжения IP-адресов. Таким механизмом является служба NAT (преобразование сетевых адресов), подключённая к вспомогательной сети VMnet8, в которую (кроме устройства NAT) входит DHCP-сервер и шлюз. Адрес «внешнего» сетевого адаптера шлюза назначается динамически (DHCP-сервером сети VMnet8) – 192.168.32.128, а  адрес «внутреннего» сетевого адаптера шлюза (входящего в сеть VMnet1) статически – 192.168.40.57.

Наконец, заметим, что виртуальные сервера DHCP всегда имеют суффикс 254 (например, 192.168.40.254 для сети VMnet1), а устройства NAT имеют суффикс 2 (например, 192.168.32.2 для сети VMnet8). 

В результате всех подключений имеем схему ККС, представленную на рисунке 2.

%------------------------------------------------------------------------------
\newpage
\section{Эмуляция ККС в среде VirtualBox}

Эмуляция ККС считается завершенной, если выполнены следующие этапы:
\begin{itemize}
\item создание и настройка виртуальных сетей
\item создание и настройка виртуальных хостов
\end{itemize}

\subsection{Создание и настройка виртуальных сетей}

Построим вспомогательную сеть VMnet8 при помощи хост-машины, которая будет через NAT обеспечивать доступ NetBSD к ресурсам сети Интернет.


\end{document}